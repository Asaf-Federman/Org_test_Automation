template: true
valuesFilePath: ../values/gitRepoValues.yml

pipelines:
  - name: S_PREPNODES
    steps:
      - name: S_PREPNODES
        type: Bash
        execution:
          onExecute:
            - echo "executing step..."

      - name: S_PREPNODES_BASH
        type: Matrix
        stepMode: Bash
        configuration:
          nodePool: u18dynamic
          multiNode: true
          inputSteps:
            - name: S_PREPNODES
        stepletMultipliers:
          environmentVariables:
            {{ range $i, $e := until 100 }}
            - foo: "bar{{$i}}"
              x: {{$i}}
            {{ end }}
        execution:
          onExecute:
            - echo "executing step..."

      - name: S_PREPNODES_PowerShell
        type: Matrix
        stepMode: Powershell
        configuration:
          nodePool: win_2019
          multiNode: true
          inputSteps:
            - name: S_PREPNODES
        stepletMultipliers:
          environmentVariables:
            {{ range $i, $e := until 50 }}
            - foo: "bar{{$i}}"
              x: {{$i}}
            {{ end }}
        execution:
          onExecute:
            - write-output "executing step..."