pipelines:
  - name: P_Pipelines_0012
    #configuration:  
    #  runtime:       
       # type: image
       # image:
       #   custom:
        #    registry: s_artifactory
         #   sourceRepository: docker-local  # required if Docker registry is Artifactory
         #   name: jfreq
         #   tag: latest
         #   autoPull: true
    steps:
      - name: P_Pipelines_0012
        type: Bash
        configuration:
          integrations:
            - name: i_dockerRegistry
            - name: s_artifactory
        execution:
          onStart:
            - printenv
            - docker pull shippabledocker/jfreq:latest
            - sudo docker login http://192.168.50.7:8082 -u admin -p AKCp5ek8CczGurADC6LVx8L6TaMgwSVakK7vQQTNpiJFMHDXvBgz7MsRX6LEz5zv37SwWuL9E
            #- sudo docker login $int_s_artifactory_url -u $int_s_artifactory_user -p $int_s_artifactory_apikey
            - sudo docker tag jfreq http://192.168.50.7:8082/docker-local/jfreq
            - sudo docker push $int_s_artifactory_url/docker-local/jfreq
            
          onExecute:
            - echo "executing step..."
            - printenv
            - sudo docker pull $int_s_artifactory_url/docker-local/jfreq
            - |
              [ "$step_image_name" == "docker-local/jfreq" ]
            - |
              [ "$step_image_tag" == "latest" ]

